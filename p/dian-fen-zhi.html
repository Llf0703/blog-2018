<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/"/>














    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            点分治总结 | 
        
        Llf&#39;s blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="https://i.loli.net/2018/05/23/5b0522df21452.png">
    <link rel="icon" href="https://i.loli.net/2018/05/23/5b0522df21452.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="Llf,Llf0703,blog,OI,博客,信息学竞赛,算法,数据结构,算法-点分治">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//css/prettify.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//css/prettify/atelier-sulphurpool-light.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 200ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//css/material-icons.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Llf&#39;s blog">
    <meta name="msapplication-starturl" content="https://v2.llf0703.com/p/dian-fen-zhi.html">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Llf&#39;s blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="https://i.loli.net/2018/05/23/5b0522df21452.png">

    <!-- Site Verification -->
    
    <meta name="baidu-site-verification" content="mjJO1sPYUA" />

    <!-- RSS -->
    
        
            <link rel=alternate type="application/atom+xml" href="/atom.xml">
        
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://v2.llf0703.com/p/dian-fen-zhi.html">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="点分治总结 | Llf&#39;s blog">
    <meta property="og:image" content="https://i.loli.net/2018/05/23/5b0522df21452.png">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="算法-点分治"> 

    
        <meta property="article:published_time" content="Thu Apr 26 2018 19:28:00 GMT+0800">
        <meta property="article:modified_time" content="Mon Jun 11 2018 20:30:46 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://v2.llf0703.com/p/dian-fen-zhi.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://v2.llf0703.com/p/dian-fen-zhi.html",
    "headline": "点分治总结",
    "datePublished": "Thu Apr 26 2018 19:28:00 GMT+0800",
    "dateModified": "Mon Jun 11 2018 20:30:46 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Llf",
        "image": {
            "@type": "ImageObject",
            "url": "https://i.loli.net/2018/06/13/5b20b90baf008.jpg"
        },
        "description": "蒟蒻Llf的博客"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Llf&#39;s blog",
        "logo": {
            "@type":"ImageObject",
            "url": "https://i.loli.net/2018/05/23/5b0522df21452.png"
        }
    },
    "keywords": ",算法-点分治Llf,Llf0703,blog,OI,博客,信息学竞赛,算法,数据结构",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#方法"><span class="post-toc-number">1.</span> <span class="post-toc-text">方法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-求重心"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.求重心</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-进行分治"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">2.进行分治</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#具体例题"><span class="post-toc-number">2.</span> <span class="post-toc-text">具体例题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-洛谷P3806-【模板】点分治1"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.洛谷P3806 【模板】点分治1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-国家集训队-聪聪可可"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.[国家集训队]聪聪可可</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-IOI2011-Race"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3.[IOI2011]Race</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-洛谷-P4178-Tree"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">4.洛谷 P4178 Tree</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(https://i.loli.net/2018/06/11/5b1e6a0c9242f.png)">
    
            <p class="article-headline-p">
                点分治总结
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="https://i.loli.net/2018/06/13/5b20b90baf008.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Llf</strong>
        <span>4月 26, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAAB4klEQVR42u3aQZLCMAwEQP7/afa6F8KMnSxL1D5REOJ0DirJ0uN5i/XAwMDAwMDAwPg3jEe8jq///Wty/51nwMDAmMl4E9pePOir/571/fE1GBgYMxl5GE0C5dr9i1COgYGBEW9znMAlYRoDAwPjioC7U4hiYGBg7DDyAvIVIA+vSep5YS2OgYHxhYy2MXDF5w/0NzAwML6EUY84lIVu3k7405kRDAyMr2Ik2x9/3yaLUdoX7IWBgTGH8ebSpUO3nWO4fCADAwNjDmPtmD5vUrbjrcnLxcDAmMbIy9QrUsB8x/q4DQMDYwwjD8H5OEV7qLd4aoiBgXEjRtJKTJB5AZwj604sBgbGTRnJn9tCt21ttsEdAwNjGiPfMg+vLbgtXzEwMGYy2qGKPGVcawMkR3gYGBhzGO3gxU6oPblVgIGBMYbRDnu1rc029czbCRgYGHMYO2liHlLbIzwMDAyM/RStHWbdWRgYGBjtajfOW5J1gMbAwBjDaANfm8DlIxd5gwEDA2MmY+chzmph5sdwGBgYkxlrQTZPCtsUcGuAFQMDYzAjL1yTwNqOemBgYGDkjDywnttgwMDAwEhul2/fpnr1q8HAwBjGaBsDa4Vrnj5iYGBgPG+xMDAwMDAwMDA+un4AbiTFOiBktlcAAAAASUVORK5CYII=">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/算法-点分治/">算法-点分治</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=点分治总结&url=https://v2.llf0703.com/p/dian-fen-zhi.html&pic=https://v2.llf0703.comhttps://i.loli.net/2018/05/23/5b0522df21452.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=点分治总结&url=https://v2.llf0703.com/p/dian-fen-zhi.html&via=Llf" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://v2.llf0703.com/p/dian-fen-zhi.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://v2.llf0703.com/p/dian-fen-zhi.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Llf&#39;s blog&title=点分治总结&summary=&pics=https://v2.llf0703.comhttps://i.loli.net/2018/05/23/5b0522df21452.png&url=https://v2.llf0703.com/p/dian-fen-zhi.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>markdown原文: <a href="https://md.llf0703.com/p/dian-fen-zhi.md" target="_blank" rel="noopener">https://md.llf0703.com/p/dian-fen-zhi.md</a></p>
<p>我自己感觉点分治是一种比较<del>玄学</del>神奇的算法，感觉自己也只是理解了一点皮毛而已。这里就谈谈点分治的实现方法和一些运用。</p>
<hr>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>点分治其实是将一棵树的点不断分为多棵子树，分别得到子树节点到子树根的距离来进行处理。</p>
<p>既然要有一个点为根节点，那么应该选取哪一个点呢？</p>
<p>既然要向下分治，如果把一个原来的叶节点作为分治的根节点，那么遍历每一个点的时间开销是非常大的。然而如果这个点的左右子树都达到最大，那么遍历的时间开销就要少很多。而<strong>子树的重心</strong>就能满足这个性质，所以我们选取<strong>子树的重心</strong>作为分治中心，即分治子树的根。</p>
<h3 id="1-求重心"><a href="#1-求重心" class="headerlink" title="1.求重心"></a>1.求重心</h3><p>首先我们需要了解重心是什么</p>
<blockquote>
<p>树的重心也叫树的质心。找到一个点,其所有的子树中最大的子树节点数最少，那么这个点就是这棵树的重心，删去重心后，生成的多棵树尽可能平衡。— 百度百科</p>
</blockquote>
<p>提取关键词：</p>
<ol>
<li><strong>其所有的子树中最大的子树节点数最少</strong></li>
<li><strong>生成的多棵树尽可能平衡</strong></li>
</ol>
<p>第1点告诉我们怎么求重心，只需要记录每一个点的子树大小，然后按着定义做就行了。</p>
<p>第2点告诉我们选择重心作为分治点的原因，因为多棵树尽可能平衡，就可以使复杂度变得最优秀。</p>
<p>这个不是重点，直接上代码（感觉和树剖差不多）：</p>
<blockquote>
<p>这里可以先不管<code>vis[]</code>，后面会解释<br>sizenow是当前这个子树的大小，后面会讲到<br>mx是当前分治到的最大的子树节点最小值</p>
</blockquote>
<pre><code class="lang-cpp">void getroot(int x,int f)
{
  size[x]=1;
  son[x]=0;
  for (int i=head[x];i;i=edge[i].next)//遍历每一个子节点
  {
    int y=edge[i].to;
    if (y==f || vis[y]) continue;
    getroot(y,x);
    size[x]+=size[y];//加上子节点的子树大小
    son[x]=max(son[x],size[y]);//求最大的子树
  }
  son[x]=max(son[x],sizenow-size[x]);
  if (son[x]&lt;mx)//使最大的子树节点最少
  {
    mx=son[x];
    root=x;//记录分治中心（根节点）
  }
}
</code></pre>
<h3 id="2-进行分治"><a href="#2-进行分治" class="headerlink" title="2.进行分治"></a>2.进行分治</h3><p>分治其实就是一个递归，不断地将子树进行处理就行了，注意要用<code>vis[]</code>标记已经访问防止重复。先上代码：</p>
<blockquote>
<p>solve就是解决问题，每一道题有不同的作用，这里不用管。</p>
</blockquote>
<pre><code class="lang-cpp">void divide(int x)
{
  vis[x]=true;//标记已访问
  solve(x,0,1);
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    solve(y,edge[i].w,0);
    mx=2147483646;root=0;sizenow=size[y];//得到当前树的大小，将mx和root初始化
    getroot(y,0);//得到子树的分治中心
    divide(root);//分治子树
  }
}
</code></pre>
<p>至于为什么有两次solve，主要是为了去重。原因如下：</p>
<blockquote>
<p>以下内容来自<a href="https://blog.csdn.net/qq_39553725/article/details/77542223" target="_blank" rel="noopener">https://blog.csdn.net/qq_39553725/article/details/77542223</a></p>
</blockquote>
<hr>
<p>对于以下这棵树：<br><img src="https://cdn.uniqueue.cn/dian-fen-zhi.png" alt="点分治"><br>显然A点是它的重心。<br>我们假设现在分治到了A点（当前点为A）<br>我们一开始求解贡献时，会有以下路径被处理出来：<br>A—&gt;A<br>A—&gt;B<br>A—&gt;B—&gt;C<br>A—&gt;B—&gt;D<br>A—&gt;E<br>A—&gt;E—&gt;F (按照先序遍历顺序罗列)<br>那么我们在合并答案是会将上述6条路径两两进行合并。<br>这是注意到：<br>合并A—&gt;B—&gt;C 和 A—&gt;B—&gt;D 肯定是不合法的！！<br>因为这并不是一条树上(简单)路径，出现了重边，我们要想办法把这种情况处理掉。<br>处理方法很简单，减去每个子树的单独贡献。<br>例如对于以B为根的子树，就会减去：<br>B—&gt;B<br>B—&gt;C<br>B—&gt;D<br>这三条路径组合的贡献<br>读者可能会有疑问，这与上面的6条路径并不一样啊。<br>我们再回过头来看一看这两句代码：<br>ans = ans + solve(tr,0);<br>ans = ans - solve(v,t[i].len);<br>注意到了吧，solve函数的第二个初始值并不相同。<br>我们在处理子树时，将初始长度设为连接边长，这样做就相当于个子树的每个组合都加上了A—&gt;的路径，从而变得与上面一样。<br>个人认为这是点分治一个极其重要的地方，读者们一定要理解清楚。</p>
<hr>
<p>好了，分治就完了。不过和树剖一样，只是剖分完是并没有什么卵用的，还需要具体问题具体分析。</p>
<h2 id="具体例题"><a href="#具体例题" class="headerlink" title="具体例题"></a>具体例题</h2><h3 id="1-洛谷P3806-【模板】点分治1"><a href="#1-洛谷P3806-【模板】点分治1" class="headerlink" title="1.洛谷P3806 【模板】点分治1"></a>1.洛谷P3806 【模板】点分治1</h3><p>题目链接：<a href="https://www.luogu.org/problemnew/show/P3806" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P3806</a></p>
<p>对于这道题询问的距离为k的点是否存在，我们可以用一种类似桶排序的笨方法，将距离作为数组下标，统计到这个距离就将数组++，最后不为0就存在，反之不存在。</p>
<p>要得到两点之间的距离，只需要记录两个点分别到根的距离，然后相加即可。</p>
<p>这里的query函数用作求当前分治到的树中点到根的距离，solve用于相加得到两点间距离并统计。</p>
<pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
struct Edge{
  int next,to,w;
} edge[20005];
int size[20005],son[20005],dis[20005],head[20005];
bool vis[20005];
int sum[10000005];//存距离是否存在，注意大小和n不一样
int n,m,k,a,b,c,ord,cnt=1,mx,root,sizenow;
inline int read()
{
  char ch=getchar();
  int f=1,x=0;
  while (ch&lt;&#39;0&#39; || ch&gt;&#39;9&#39;)
  {
    if (ch==&#39;-&#39;) f=-1;
    ch=getchar();
  }
  while (ch&gt;=&#39;0&#39; &amp;&amp; ch&lt;=&#39;9&#39;)
  {
    x=x*10+ch-&#39;0&#39;;
    ch=getchar();
  }
  return f*x;
}
inline void add(int u,int v,int w)
{
  edge[cnt].to=v;
  edge[cnt].w=w;
  edge[cnt].next=head[u];
  head[u]=cnt++;
}
void getroot(int x,int f)
{
  size[x]=1;
  son[x]=0;
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (y==f || vis[y]) continue;
    getroot(y,x);
    size[x]+=size[y];
    son[x]=max(son[x],size[y]);
  }
  son[x]=max(son[x],sizenow-size[x]);
  if (son[x]&lt;mx)
  {
    mx=son[x];
    root=x;
  }
}
void query(int x,int f,int dist)
{
  dis[++ord]=dist;//得到到根的距离
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (y==f || vis[y]) continue;
    query(y,x,dist+edge[i].w);//查询子节点
  }
}
void solve(int x,int length,bool s) //s=false时要去重
{
  ord=0;
  query(x,0,length);
  for (int i=1;i&lt;=ord-1;i++)
    for (int j=i+1;j&lt;=ord;j++)
    {
      if (s==true) sum[dis[i]+dis[j]]++;
      else sum[dis[i]+dis[j]]--; //进行统计
    }
}
void divide(int x)
{
  vis[x]=true;
  solve(x,0,1);
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    solve(y,edge[i].w,0);
    mx=2147483646;root=0;sizenow=size[y];
    getroot(y,0);
    divide(root);
  }
}
int main()
{
  memset(vis,false,sizeof(vis));
  n=read();m=read();
  for (int i=1;i&lt;n;i++)
  {
    a=read();b=read();c=read();
    add(a,b,c);
    add(b,a,c);
  }
  root=0;mx=2147483646;sizenow=n;
  getroot(1,0);
  divide(root);
  for (int i=1;i&lt;=m;i++)
  {
    a=read();
    if (sum[a]) printf(&quot;AYE\n&quot;);
    else printf(&quot;NAY\n&quot;);
  }
  return 0;
}
</code></pre>
<h3 id="2-国家集训队-聪聪可可"><a href="#2-国家集训队-聪聪可可" class="headerlink" title="2.[国家集训队]聪聪可可"></a>2.[国家集训队]聪聪可可</h3><p>题目链接： </p>
<ul>
<li>洛谷 P2634： <a href="https://www.luogu.org/problemnew/show/P2634" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P2634</a> </li>
<li>BZOJ P2152： <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2152" target="_blank" rel="noopener">https://www.lydsy.com/JudgeOnline/problem.php?id=2152</a></li>
</ul>
<p>这里使用一个<code>mod3[3]</code>数组来记录两点间距离%3后的值分别为0,1,2的个数。</p>
<p>对每个节点求出其子树内的dis，经过该点的路径数即为<code>mod3[1]*mod3[2]*2+mod3[0]^2</code>。</p>
<p>因为要求答案互质，所以还需要一个求最大公约数的操作。</p>
<pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
struct Edge{
  int next,to,w;
} edge[40005];
int head[40005],size[40005],son[40005],mod3[3];
bool vis[40005];
int n,m,a,b,c,cnt=1,ord,root,mx,sizenow,ans;
inline int read()
{
  char ch=getchar();
  int f=1,x=0;
  while (ch&lt;&#39;0&#39; || ch&gt;&#39;9&#39;)
  {
    if (ch==&#39;-&#39;) f=-1;
    ch=getchar();
  }
  while (ch&gt;=&#39;0&#39; &amp;&amp; ch&lt;=&#39;9&#39;)
  {
    x=x*10+ch-&#39;0&#39;;
    ch=getchar();
  }
  return f*x;
}
inline void add(int u,int v,int w)
{
  edge[cnt].to=v;
  edge[cnt].w=w;
  edge[cnt].next=head[u];
  head[u]=cnt++;
}
inline void init(int sizen)
{
  mx=2147483647;root=0;sizenow=sizen;
}
void getroot(int x,int f)
{
  size[x]=1;
  son[x]=0;
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y] || y==f) continue;
    getroot(y,x);
    size[x]+=size[y];
    son[x]=max(son[x],size[y]);
  }
  son[x]=max(son[x],sizenow-size[x]);
  if (mx&gt;son[x])
  {
    mx=son[x];
    root=x;
  }
}
void query(int x,int f,int dist)
{
  mod3[dist%3]++;
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y] || y==f) continue;
    query(y,x,dist+edge[i].w);
  }
}
inline int solve(int x,int length)
{
  memset(mod3,0,sizeof(mod3));
  query(x,0,length);
  return mod3[0]*mod3[0]+mod3[1]*mod3[2]*2;
}
void divide(int x)
{
  vis[x]=true;
  ans+=solve(x,0);
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    ans-=solve(y,edge[i].w);
    init(size[y]);
    getroot(y,0);
    divide(root);
  }
}
int gcd(int x,int y)//求最大公约数
{
  if (y==0) return x;
  return gcd(y,x%y);
}
int main()
{
  n=read();
  for (int i=1;i&lt;n;i++)
  {
    a=read();b=read();c=read();
    add(a,b,c);
    add(b,a,c);
  }
  init(n);
  getroot(1,0);
  divide(root);
  printf(&quot;%d%c%d&quot;,ans/gcd(ans,n*n),&#39;/&#39;,n*n/gcd(ans,n*n));
  return 0;
}
</code></pre>
<h3 id="3-IOI2011-Race"><a href="#3-IOI2011-Race" class="headerlink" title="3.[IOI2011]Race"></a>3.[IOI2011]Race</h3><p>题目链接：</p>
<ul>
<li>洛谷 P4149：<a href="https://www.luogu.org/problemnew/show/P4149" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P4149</a></li>
<li>BZOJ P2599: <a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2599" target="_blank" rel="noopener">https://www.lydsy.com/JudgeOnline/problem.php?id=2599</a></li>
</ul>
<blockquote>
<p>BZOJ是权限题，若没交钱就用洛谷，或者用离线BZOJ题库（by ruanxingzhi）：<br><a href="https://bzoj.llf0703.com/p/2599.html" target="_blank" rel="noopener">https://bzoj.llf0703.com/p/2599.html</a></p>
</blockquote>
<p><del>洛谷上这道题是<a href="https://www.luogu.org/space/show?uid=20438" target="_blank" rel="noopener">@larryzhong</a>大佬提供的，比我小3岁却吊打我，在这里先%%%为敬</del></p>
<p>因为这道题需要得到边数最小，我们对于距离为i的点建立<code>tmp[i]</code>，表示在当前递归到的子树中，走到距离为i的顶点最少需要走多少边</p>
<p>点分治，每次先对每棵子树遍历，求出每个点i到root的距离<code>dis[i]</code>，以及走过的边数<code>d[i]</code>，那么<code>ans=min(ans,tmp[k-dis[i]]+d[i])</code>.</p>
<p>遍历完这棵子树再修改被访问了的tmp[dis[i]]，然后下一棵。最后所有子树遍历完了以后，再遍历一遍所有节点，把修改到的tmp值变回inf（初始就是inf）</p>
<pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
#define maxint 1e9
using namespace std;
struct Edge{
  int next,to,w;
} edge[400005];
bool vis[200005];
int size[200005],son[200005],dis[200005],head[400005],esum[200005];
//tmp[i]，表示在当前递归到的子树中，走到距离为i的顶点最少需要走多少边
//每个点i到root的距离dis[i]，以及走过的边数esum[i]
int tmp[1000005];
int n,m,k,a,b,c,cnt=1,sizenow,mx,ans,root;
inline int read()
{
  char ch=getchar();
  int f=1,x=0;
  while (ch&lt;&#39;0&#39; || ch&gt;&#39;9&#39;)
  {
    if (ch==&#39;-&#39;) f=-1;
    ch=getchar();
  }
  while (ch&gt;=&#39;0&#39; &amp;&amp; ch&lt;=&#39;9&#39;)
  {
    x=x*10+ch-&#39;0&#39;;
    ch=getchar();
  }
  return x*f;
}
inline void add(int u,int v,int w)
{
  edge[cnt].to=v;
  edge[cnt].w=w;
  edge[cnt].next=head[u];
  head[u]=cnt++;
}
inline void init(int sizen)
{
  mx=maxint;
  root=0;
  sizenow=sizen;
}
void getroot(int x,int f)
{
  size[x]=1;
  son[x]=0;
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y] || y==f) continue;
    getroot(y,x);
    size[x]+=size[y];
    son[x]=max(son[x],size[y]);
  }
  son[x]=max(son[x],sizenow-son[x]);
  if (mx&gt;son[x])
  {
    mx=son[x];
    root=x;
  }
}
void query(int x,int f,int dist,int edgesum)
{
  dis[x]=dist;
  esum[x]=edgesum;
  if (dis[x]&lt;=k) ans=min(ans,tmp[k-dis[x]]+esum[x]);
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (y==f || vis[y]) continue;
    query(y,x,dist+edge[i].w,edgesum+1);
  }
}
//遍历完这棵子树再修改被访问了的tmp[dis[i]]，然后下一棵
void update(int x,int f,bool s)
{
  if (dis[x]&lt;=k)
    if (s) tmp[dis[x]]=min(tmp[dis[x]],esum[x]);
    else tmp[dis[x]]=maxint;
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (y==f || vis[y]) continue;
    update(y,x,s);
  }
}
void divide(int x)
{
  vis[x]=true;
  tmp[0]=0;//每次进入dfs_solve时tmp[0]=0，因为这个当前的根到自己距离为0，走过了0条边
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    query(y,0,edge[i].w,1);
    update(y,0,true);
  }
  for (int i=head[x];i;i=edge[i].next)//所有子树遍历完了以后，再遍历一遍所有节点，把修改到的tmp值变回inf（初始就是inf）
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    update(y,0,false);
  }
  for (int i=head[x];i;i=edge[i].next)
  {
    int y=edge[i].to;
    if (vis[y]) continue;
    init(size[y]);
    getroot(y,0);
    divide(root);
  }
}
int main()
{
  n=read();k=read();
  for (int i=1;i&lt;=k;i++) tmp[i]=maxint;
  ans=maxint;
  for (int i=1;i&lt;n;i++)
  {
    a=read();b=read();c=read();
    a++;b++;
    add(a,b,c);
    add(b,a,c);
  }
  init(n);
  getroot(1,0);
  divide(root);
  if (ans==maxint) printf(&quot;-1&quot;);
  else printf(&quot;%d&quot;,ans);
  return 0;
}
</code></pre>
<h3 id="4-洛谷-P4178-Tree"><a href="#4-洛谷-P4178-Tree" class="headerlink" title="4.洛谷 P4178 Tree"></a>4.洛谷 P4178 Tree</h3><p>题目链接： <a href="https://www.luogu.org/problemnew/show/P4178" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P4178</a></p>
<p><del>这道题好像比上面那道还简单一点，我也不知道我为什么先刷的上面那一道</del></p>
<p>注意的是可以在统计有多少个路径权值&lt;=k时可以进行一次排序，直接枚举两个端点就可以处理了，可以节省时间。</p>
<pre><code class="lang-cpp">#include&lt;bits/stdc++.h&gt;
#define inf 0xfffffff
using namespace std;
struct Edge{
    int next,to,w;
} edge[80005];
bool vis[40005];
int dis[40005],size[40005],son[40005],head[40005];
int root,mx,sizenow,cnt=1,n,m,a,b,c,ord,k,ans;
inline int read()
{
    char ch=getchar();
    int f=1,x=0;
    while (ch&lt;&#39;0&#39; || ch&gt;&#39;9&#39;)
    {
        if (ch==&#39;-&#39;) f=-1;
        ch=getchar();
    }
    while (ch&gt;=&#39;0&#39; &amp;&amp; ch&lt;=&#39;9&#39;)
    {
        x=x*10+ch-&#39;0&#39;;
        ch=getchar();
    }
    return f*x;
}
inline void add(int u,int v,int w)
{
    edge[cnt].to=v;
    edge[cnt].w=w;
    edge[cnt].next=head[u];
    head[u]=cnt++;
}
inline void init(int sizen)
{
    mx=inf; sizenow=sizen; root=0;
}
void getroot(int x,int f)
{
    size[x]=1;
    son[x]=0;
    for (int i=head[x];i;i=edge[i].next)
    {
        int y=edge[i].to;
        if (y==f || vis[y]) continue;
        getroot(y,x);
        size[x]+=size[y];
        son[x]=max(son[x],size[y]);
    }
    son[x]=max(son[x],sizenow-size[x]);
    if (mx&gt;son[x])
    {
        mx=son[x];
        root=x;
    }
}
void query(int x,int f,int dist)
{
    dis[++ord]=dist;
    for (int i=head[x];i;i=edge[i].next)
    {
        int y=edge[i].to;
        if (y==f || vis[y]) continue;
        query(y,x,dist+edge[i].w);
    }
}
inline int solve(int x,int length)
{
    ord=0;
    query(x,0,length);
    sort(dis+1,dis+ord+1);
    int ans=0,stat=1;
    while (stat&lt;ord)
    {
        if (dis[stat]+dis[ord]&lt;=k)
        {
            ans+=ord-stat;
            stat++;
        }
        else ord--;
    }
    return ans;
}
void divide(int x)
{
    ans+=solve(x,0);
    vis[x]=true;
    for (int i=head[x];i;i=edge[i].next)
    {
        int y=edge[i].to;
        if (vis[y]) continue;
        ans-=solve(y,edge[i].w);
        init(size[y]);
        getroot(y,0);
        divide(root);
    }
}
int main()
{
    n=read();
    for (int i=1;i&lt;n;i++)
    {
        a=read();b=read();c=read();
        add(a,b,c);
        add(b,a,c);
    }
    k=read();
    init(n);
    getroot(1,0);
    divide(root);
    printf(&quot;%d&quot;,ans);
    return 0;
}
</code></pre>
<p>以上内容更新于2018.4.26</p>
<hr>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。<br/> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0 International License</a>.
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="https://v2.llf0703.com/p/dian-fen-zhi.html">https://v2.llf0703.com/p/dian-fen-zhi.html</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 gitcoment -->
<div id="gitment-comment">
    <!-- Gitment 评论框 -->
<div id="container"></div>
</div>
<style>
    #gitment-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
        //id: '页面 ID', // 可选。默认为 location.href
        owner: '',
        repo: '',
        oauth: {
            client_id: '',
            client_secret: '',
        },
    })
    gitment.render('container')
</script>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/p/number-theory.html" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/p/luogu-solution-p4092.html" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(https://i.loli.net/2018/06/13/5b20b9333971c.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="https://i.loli.net/2018/06/13/5b20b90baf008.jpg" alt="Llf's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        llf0703@foxmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:llf0703@foxmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/OI笔记/">OI笔记<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/游记/">游记<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/题解/">题解<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags/" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">tab</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline/" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">watch_later</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/about/" title="关于">
                
                    <i class="material-icons sidebar-material-icons">account_circle</i>
                
                关于
            </a>
        </li>
        
    
        <li>
            <a href="/links/" title="友链">
                
                    <i class="material-icons sidebar-material-icons">supervisor_account</i>
                
                友链
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/Llf0703/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/llf-93-87/activities/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    
        <a href="https://space.bilibili.com/268840304/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-bilibili">
                <span class="visuallyhidden">Bilibili</span>
            </button><!--
     --></a>
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Llf's blog
            
                <br>
                
                    <a href="https://s01.flagcounter.com/count2/fgaz/bg_FFFFFF/txt_000000/border_FFFFFF/columns_3/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/percent_0/" target="_blank" class="footer-develop-a">访客统计</a>
                
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source//js/nprogress.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#00626B'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #00626B, 0 0 15px #00626B'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#00626B',
        'border-left-color': '#00626B'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 200);
</script>









   <!-- Gitment -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","https://cdn.bootcss.com/prettify/r298/prettify.min.js", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
    
</html>
